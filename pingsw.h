#define MAX_RETRIES 5

typedef uint32_t ipaddr; /* Una direccion ip en formato de entero sin signo */

/* Estructura de un paquete ARP. */
/* Capitulos 2 y 4, TCP/IP  Illustrado volumen 1: The protocols */
/*#pragma pack(1) /* Acomoda cada campo de la estructura uno tras otro */
typedef struct __attribute__((__packed__)) arp_packet
{
  /* Cabeceras de ethernet */
  unsigned char mac_dst[6];
  unsigned char mac_src[6];
  unsigned short int frame_type;
  /* Cabeceras de ARP */
  unsigned short int hw_type;
  unsigned short int proto_type;
  unsigned char hw_size;
  unsigned char proto_size;
  unsigned short int opcode;
  unsigned char mac_sender[6];
  ipaddr ip_sender;
  unsigned char mac_target[6];
  ipaddr ip_target;
  /* Padding */
  unsigned char padding[18];
} arp_pkt;

void range_of_hosts(char *, ipaddr *, ipaddr *, ipaddr *);
int send_arp_packet(char *, ipaddr, ipaddr);
